generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model repos_metadata {
  repo_url          String       @id
  source_file_count Int?         @default(0)
  total_loc         Int?         @default(0)
  language          String?
  metadata          String
  repositories      repositories @relation(fields: [repo_url], references: [repo_url], onDelete: Cascade, onUpdate: NoAction) @ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model repositories {
  repo_url       String?         @id
  repo_name      String
  repo_owner     String
  customer_id    String?
  team_id        String
  default_branch String?
  status         String?         @default("unclaimed")
  priority       Int?            @default(0)
  claimed_at     Float?
  claim_ttl      Int?
  jdk_version    String?
  repos_metadata repos_metadata?

  @@index([status], map: "idx_repos_status")
  @@index([status, priority(sort: Desc), repo_url], map: "idx_repos_unclaimed")
  @@ignore
}
